# NovelGrok - AIå°è¯´å†™ä½œå·¥å…·

ä¸€ä¸ªåŸºäºPythonå’ŒGrok APIçš„æ™ºèƒ½å°è¯´å†™ä½œå·¥å…·ï¼Œä¸“é—¨è®¾è®¡æ¥è§£å†³AIå†™ä½œä¸­çš„ä¸Šä¸‹æ–‡é—®é¢˜ã€‚

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

- ğŸ“š **æ™ºèƒ½ä¸Šä¸‹æ–‡ç®¡ç†**: åˆ†å±‚ä¸Šä¸‹æ–‡æ¶æ„ï¼Œè§£å†³tokené™åˆ¶é—®é¢˜
- ğŸ‘¥ **è§’è‰²ä¸€è‡´æ€§è·Ÿè¸ª**: ç»´æŠ¤è§’è‰²ä¿¡æ¯ã€æ€§æ ¼ç‰¹å¾å’Œå…³ç³»ç½‘ç»œ
- ğŸ“– **æƒ…èŠ‚è¿è´¯ç®¡ç†**: è·Ÿè¸ªæ•…äº‹çº¿ç´¢å’Œé‡è¦äº‹ä»¶ï¼Œä¿æŒé€»è¾‘ä¸€è‡´
- ğŸ§  **è‡ªåŠ¨æ‘˜è¦ç”Ÿæˆ**: ä¸ºé•¿ç« èŠ‚ç”Ÿæˆæ‘˜è¦ï¼Œä¼˜åŒ–ä¸Šä¸‹æ–‡ä½¿ç”¨
- ğŸ“ **å¤šç§å†™ä½œæ¨¡å¼**: æ–°ç« èŠ‚ç”Ÿæˆã€ç»­å†™ã€æ”¹è¿›ç­‰å¤šç§æ¨¡å¼
- ğŸ’¾ **å®Œæ•´é¡¹ç›®ç®¡ç†**: é¡¹ç›®ä¿å­˜ã€åŠ è½½ã€å¯¼å‡ºç­‰å®Œæ•´åŠŸèƒ½
- ğŸŒ **Webå¯è§†åŒ–ç•Œé¢**: ç¾è§‚æ˜“ç”¨çš„Webç•Œé¢ï¼Œæ‰€è§å³æ‰€å¾—
- ğŸ–¥ï¸ **å‘½ä»¤è¡Œç•Œé¢**: å¼ºå¤§çš„CLIå·¥å…·ï¼Œæ˜“äºä½¿ç”¨

## ğŸ§  ä¸Šä¸‹æ–‡é—®é¢˜è§£å†³æ–¹æ¡ˆ

### ä¼ ç»ŸAIå†™ä½œçš„é—®é¢˜
- **Tokençª—å£é™åˆ¶**: æ— æ³•å¤„ç†é•¿ç¯‡å°è¯´çš„å®Œæ•´ä¸Šä¸‹æ–‡
- **ä¿¡æ¯é—å¿˜**: è§’è‰²è®¾å®šå’Œæ—©æœŸæƒ…èŠ‚å®¹æ˜“è¢«é—å¿˜
- **ä¸€è‡´æ€§ç¼ºå¤±**: è§’è‰²æ€§æ ¼ã€æ•…äº‹é€»è¾‘å‡ºç°çŸ›ç›¾

### æˆ‘ä»¬çš„åˆ›æ–°è§£å†³æ–¹æ¡ˆ

#### 1. åˆ†å±‚ä¸Šä¸‹æ–‡æ¶æ„
```
ä¸Šä¸‹æ–‡åˆ†é…ç­–ç•¥:
â”œâ”€â”€ åŸºç¡€ä¿¡æ¯ (30%) â”€â”€ è§’è‰²è®¾å®šã€æ•…äº‹èƒŒæ™¯ã€å¤§çº²
â”œâ”€â”€ è¿‘æœŸå†…å®¹ (50%) â”€â”€ æœ€è¿‘2-3ç« çš„å®Œæ•´æ–‡æœ¬  
â””â”€â”€ å†å²æ‘˜è¦ (20%) â”€â”€ æ—©æœŸç« èŠ‚çš„å…³é”®ä¿¡æ¯
```

#### 2. æ™ºèƒ½Tokenä¼˜åŒ–
- **åŠ¨æ€å†…å®¹é€‰æ‹©**: æ ¹æ®å½“å‰å†™ä½œéœ€è¦é€‰æ‹©æœ€ç›¸å…³çš„å†å²å†…å®¹
- **è‡ªåŠ¨æ‘˜è¦å‹ç¼©**: å°†å†—é•¿ç« èŠ‚å‹ç¼©ä¸ºå…³é”®ä¿¡æ¯ç‚¹
- **Tokené¢„ç®—ç®¡ç†**: æ™ºèƒ½åˆ†é…tokenä½¿ç”¨ï¼Œæœ€å¤§åŒ–æœ‰æ•ˆä¿¡æ¯å¯†åº¦

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
# è™šæ‹Ÿç¯å¢ƒå·²åˆ›å»ºï¼ˆvenv/ï¼‰
# ä¾èµ–å·²å®‰è£…ï¼ˆopenai, python-dotenvï¼‰
```

### é…ç½®API

1. å¤åˆ¶ `.env.example` åˆ° `.env`
2. åœ¨ `.env` ä¸­è®¾ç½®ä½ çš„Grok APIå¯†é’¥ï¼š
```env
XAI_API_KEY=your_grok_api_key_here
XAI_BASE_URL=https://api.x.ai/v1
```

### è¿è¡Œç¤ºä¾‹

```bash
# è¿è¡ŒåŠŸèƒ½æ¼”ç¤ºï¼ˆæ— éœ€APIé…ç½®ï¼‰
python example.py

# æŸ¥çœ‹æ‰€æœ‰å‘½ä»¤
python main.py --help
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### ğŸŒ Webç•Œé¢ï¼ˆæ¨èï¼‰

```bash
# å¯åŠ¨WebæœåŠ¡å™¨
python web_api.py

# åœ¨æµè§ˆå™¨ä¸­è®¿é—®
http://localhost:5001
```

**Webç•Œé¢åŠŸèƒ½**ï¼š
- âœ… åˆ›å»ºå’Œç®¡ç†é¡¹ç›®
- âœ… æ·»åŠ å’Œç¼–è¾‘è§’è‰²
- âœ… æ‰‹åŠ¨æ·»åŠ å’Œç¼–è¾‘ç« èŠ‚
- âœ… AIç”Ÿæˆæ–°ç« èŠ‚
- âœ… AIç»­å†™ç« èŠ‚
- âœ… AIç”Ÿæˆæ‘˜è¦
- âœ… è·å–æƒ…èŠ‚å»ºè®®
- âœ… å®æ—¶ç»Ÿè®¡æ•°æ®å¯è§†åŒ–
- âœ… ç¾è§‚çš„ç°ä»£åŒ–ç•Œé¢

è¯¦ç»†ä½¿ç”¨è¯´æ˜è¯·æŸ¥çœ‹ [WEB_GUIDE.md](WEB_GUIDE.md)

### ğŸ–¥ï¸ å‘½ä»¤è¡Œç•Œé¢

#### åˆ›å»ºé¡¹ç›®
```bash
python main.py create-project "æˆ‘çš„å°è¯´" \
  --genre "ç§‘å¹»" \
  --background "2030å¹´çš„AIæ—¶ä»£" \
  --outline "ç¨‹åºå‘˜å‘ç°AIè§‰é†’çš„æ•…äº‹"
```

#### æ·»åŠ è§’è‰²
```bash
python main.py add-character "æˆ‘çš„å°è¯´" "ææ˜" \
  "28å²çš„AIå·¥ç¨‹å¸ˆ" \
  --personality "èªæ˜ã€å¥½å¥‡ã€æœ‰äº›å†…å‘" \
  --background "è®¡ç®—æœºç§‘å­¦åšå£«"
```

#### ç”Ÿæˆæ–°ç« èŠ‚ (éœ€è¦API)
```bash
python main.py generate-chapter "æˆ‘çš„å°è¯´" \
  --title "è§‰é†’" \
  --prompt "æå†™AIç¬¬ä¸€æ¬¡å±•ç°è‡ªæˆ‘æ„è¯†çš„åœºæ™¯" \
  --length 3500 \
  --summary
```

#### ç»­å†™å½“å‰ç« èŠ‚ (éœ€è¦API)
```bash
python main.py continue-writing "æˆ‘çš„å°è¯´" \
  --prompt "å¢åŠ ä¸€æ®µç´§å¼ çš„å¯¹è¯" \
  --length 1000
```

#### æ”¹è¿›ç« èŠ‚ (éœ€è¦API)
```bash
python main.py improve-chapter "æˆ‘çš„å°è¯´" 1 \
  --focus "å¢åŠ å¯¹è¯å’Œç»†èŠ‚æå†™" \
  --save
```

#### è·å–æƒ…èŠ‚å»ºè®® (éœ€è¦API)
```bash
python main.py suggest-plot "æˆ‘çš„å°è¯´" --count 3
```

#### ç”Ÿæˆæ‘˜è¦ (éœ€è¦API)
```bash
python main.py generate-summary "æˆ‘çš„å°è¯´" 1
```

#### æŸ¥çœ‹é¡¹ç›®çŠ¶æ€
```bash
python main.py status "æˆ‘çš„å°è¯´" --context
```

#### åˆ—å‡ºæ‰€æœ‰é¡¹ç›®
```bash
python main.py list-projects
```

#### å¯¼å‡ºå°è¯´
```bash
# å¯¼å‡ºä¸ºTXT
python export.py "æˆ‘çš„å°è¯´" --format txt

# å¯¼å‡ºä¸ºMarkdown
python export.py "æˆ‘çš„å°è¯´" --format md

# å¯¼å‡ºä¸ºHTML
python export.py "æˆ‘çš„å°è¯´" --format html

# å¯¼å‡ºæ‰€æœ‰æ ¼å¼
python export.py "æˆ‘çš„å°è¯´" --format all
```

### ğŸ Python API

```python
from novel_ai import NovelProject, Character, GrokClient, ContextManager

# 1. åˆ›å»ºé¡¹ç›®
project = NovelProject("æˆ‘çš„ç§‘å¹»å°è¯´")
project.genre = "ç§‘å¹»"
project.background = "2030å¹´çš„AIæ—¶ä»£"
project.plot_outline = "ç¨‹åºå‘˜å‘ç°AIè§‰é†’çš„æ•…äº‹"

# 2. æ·»åŠ è§’è‰²
protagonist = Character(
    name="ææ˜",
    description="28å²çš„AIå·¥ç¨‹å¸ˆ",
    personality="èªæ˜ã€å¥½å¥‡ã€æœ‰äº›å†…å‘"
)
project.add_character(protagonist)

# 3. ä¸Šä¸‹æ–‡ç®¡ç†æ¼”ç¤º
context_manager = ContextManager(max_tokens=20000)
context = context_manager.build_writing_context(project)
print(f"ä¸Šä¸‹æ–‡Tokenæ•°: {context_manager.count_tokens(context)}")

# 4. AIç”Ÿæˆ (éœ€è¦é…ç½®API)
client = GrokClient()
chapter = client.generate_new_chapter(project, "è§‰é†’")
project.add_chapter(chapter)

# 5. ä¿å­˜é¡¹ç›®
project.save()
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
NovelGrok/
â”œâ”€â”€ novel_ai/              # æ ¸å¿ƒåŠŸèƒ½åŒ…
â”‚   â”œâ”€â”€ core/             # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ project.py          # é¡¹ç›®å’Œç« èŠ‚ç®¡ç†
â”‚   â”‚   â””â”€â”€ context_manager.py  # ä¸Šä¸‹æ–‡ç®¡ç†å™¨ (æ ¸å¿ƒ!)
â”‚   â”œâ”€â”€ api/              # APIå®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ grok_client.py      # Grok APIé›†æˆ
â”‚   â”œâ”€â”€ utils/            # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ text_utils.py       # æ–‡æœ¬å¤„ç†å·¥å…·
â”‚   â””â”€â”€ cli/              # å‘½ä»¤è¡Œæ¥å£
â”‚       â””â”€â”€ commands.py         # CLIå‘½ä»¤å®ç°
â”œâ”€â”€ projects/             # é¡¹ç›®å­˜å‚¨ç›®å½•
â”œâ”€â”€ main.py              # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ example.py           # åŠŸèƒ½æ¼”ç¤ºç¤ºä¾‹
â”œâ”€â”€ export.py            # å¯¼å‡ºå·¥å…·
â”œâ”€â”€ requirements.txt     # ä¾èµ–åˆ—è¡¨
â””â”€â”€ .env.example         # ç¯å¢ƒå˜é‡æ¨¡æ¿
```

## ğŸ›ï¸ æ ¸å¿ƒåŠŸèƒ½è¯¦è§£

### ä¸Šä¸‹æ–‡ç®¡ç†å™¨ (`ContextManager`)
è§£å†³ä¸Šä¸‹æ–‡é—®é¢˜çš„æ ¸å¿ƒç»„ä»¶ï¼š

```python
# åˆ›å»ºä¸Šä¸‹æ–‡ç®¡ç†å™¨
context_manager = ContextManager(max_tokens=20000)

# æ„å»ºå†™ä½œä¸Šä¸‹æ–‡
context = context_manager.build_writing_context(
    project,
    include_full_recent=2,     # åŒ…å«æœ€è¿‘2ç« å®Œæ•´å†…å®¹
    include_summary_count=5    # åŒ…å«å‰5ç« æ‘˜è¦
)

# Tokenè®¡ç®—å’Œä¼˜åŒ–
token_count = context_manager.count_tokens(context)
print(f"å½“å‰ä¸Šä¸‹æ–‡: {token_count}/{context_manager.max_tokens} tokens")

# è‡ªåŠ¨ç”Ÿæˆç« èŠ‚æ‘˜è¦
summary = context_manager.generate_chapter_summary(chapter)
```

### é¡¹ç›®ç®¡ç† (`NovelProject`)

```python
# åˆ›å»ºå’Œé…ç½®é¡¹ç›®
project = NovelProject("å°è¯´æ ‡é¢˜")
project.genre = "ç±»å‹"
project.background = "èƒŒæ™¯è®¾å®š"

# è§’è‰²ç®¡ç†
character = Character(name="è§’è‰²å", description="æè¿°")
project.add_character(character)

# ç« èŠ‚ç®¡ç†
chapter = Chapter(title="ç« èŠ‚æ ‡é¢˜", content="å†…å®¹")
project.add_chapter(chapter)

# ä¿å­˜å’ŒåŠ è½½
project.save()
loaded_project = NovelProject.load("å°è¯´æ ‡é¢˜")
```

### Grok APIå®¢æˆ·ç«¯ (`GrokClient`)

```python
client = GrokClient()

# ç”Ÿæˆæ–°ç« èŠ‚
chapter = client.generate_new_chapter(project, "ç« èŠ‚æ ‡é¢˜")

# ç»­å†™ç« èŠ‚
continuation = client.continue_chapter(project)

# ç”Ÿæˆæ‘˜è¦
summary = client.generate_chapter_summary(chapter, project)

# æƒ…èŠ‚å»ºè®®
suggestions = client.suggest_plot_development(project)

# æ”¹è¿›ç« èŠ‚
improved = client.improve_chapter(chapter, project)
```

## ğŸ“Š æ•ˆæœå¯¹æ¯”

### Tokenä½¿ç”¨æ•ˆç‡
| æ–¹å¼ | Tokené™åˆ¶ | å¯åŒ…å«å†…å®¹ | ä¿¡æ¯å¯†åº¦ |
|------|-----------|------------|----------|
| ä¼ ç»Ÿæ–¹å¼ | 20000 | 2-3ä¸ªå®Œæ•´ç« èŠ‚ | ä½ |
| æˆ‘ä»¬çš„æ–¹æ¡ˆ | 20000 | 10+ç« èŠ‚æ ¸å¿ƒä¿¡æ¯ | é«˜ |

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### æœ€ä½³å®è·µ
1. **è¯¦ç»†è®¾å®š**: å……åˆ†è®¾ç½®è§’è‰²æ€§æ ¼ã€èƒŒæ™¯ä¿¡æ¯
2. **é€‚åº¦é•¿åº¦**: æ¯ç« 1500-3500å­—è¾ƒä¸ºåˆé€‚
3. **å®šæœŸæ‘˜è¦**: åŠæ—¶ç”Ÿæˆç« èŠ‚æ‘˜è¦ï¼Œä¿æŒä¸Šä¸‹æ–‡æ¸…æ™°
4. **è¿­ä»£æ”¹è¿›**: ä½¿ç”¨æ”¹è¿›åŠŸèƒ½ä¼˜åŒ–å†…å®¹è´¨é‡

### æ¨èå·¥ä½œæµç¨‹
```
åˆ›å»ºé¡¹ç›® â†’ è®¾ç½®èƒŒæ™¯ â†’ æ·»åŠ è§’è‰² â†’ åˆ¶å®šå¤§çº²
    â†“
ç”Ÿæˆé¦–ç«  â†’ ç”Ÿæˆæ‘˜è¦ â†’ ç»­å†™ç« èŠ‚ â†’ é€‚æ—¶è°ƒæ•´
    â†“
å†…å®¹æ”¹è¿› â†’ æƒ…èŠ‚å»ºè®® â†’ æœ€ç»ˆå¯¼å‡º
```

## â“ å¸¸è§é—®é¢˜

**Q: å¿…é¡»ä½¿ç”¨Grok APIå—ï¼Ÿ**  
A: ä¸æ˜¯å¿…é¡»çš„ã€‚æ ¸å¿ƒçš„é¡¹ç›®ç®¡ç†ã€ä¸Šä¸‹æ–‡æ„å»ºåŠŸèƒ½éƒ½å¯ä»¥ç‹¬ç«‹ä½¿ç”¨ã€‚

**Q: ä¸­æ–‡æ”¯æŒå¦‚ä½•ï¼Ÿ**  
A: å®Œå…¨æ”¯æŒä¸­æ–‡ï¼ŒåŒ…æ‹¬å­—æ•°ç»Ÿè®¡ã€å…³é”®è¯æå–ç­‰åŠŸèƒ½éƒ½é’ˆå¯¹ä¸­æ–‡ä¼˜åŒ–ã€‚

**Q: é¡¹ç›®æ•°æ®å®‰å…¨å—ï¼Ÿ**  
A: æ‰€æœ‰æ•°æ®éƒ½ä¿å­˜åœ¨æœ¬åœ°ï¼Œç¡®ä¿éšç§å®‰å…¨ã€‚

**Q: å¦‚ä½•å¤„ç†è¶…é•¿å°è¯´ï¼Ÿ**  
A: è‡ªåŠ¨æ‘˜è¦ç³»ç»Ÿå¯ä»¥æ— é™å‹ç¼©å†å²å†…å®¹ï¼Œç†è®ºä¸Šæ”¯æŒä»»æ„é•¿åº¦çš„å°è¯´ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License
