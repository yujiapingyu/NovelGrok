# NovelGrok - AI小说写作工具

一个基于Python和Grok API的智能小说写作工具。

## 🎯 核心特性

- 📚 **智能上下文管理**: 分层上下文架构，解决token限制问题
- 👥 **角色一致性跟踪**: 维护角色信息、性格特征和关系网络
- 📖 **情节连贯管理**: 跟踪故事线索和重要事件，保持逻辑一致
- 🧠 **自动摘要生成**: 为长章节生成摘要，优化上下文使用
- 📝 **多种写作模式**: 新章节生成、续写、改进等多种模式
- 💾 **完整项目管理**: 项目保存、加载、导出等完整功能
- 🌐 **Web可视化界面**: 美观易用的Web界面，所见即所得

## 🧠 上下文问题解决方案

### 传统AI写作的问题
- **Token窗口限制**: 无法处理长篇小说的完整上下文
- **信息遗忘**: 角色设定和早期情节容易被遗忘
- **一致性缺失**: 角色性格、故事逻辑出现矛盾

### 我们的创新解决方案

#### 1. 分层上下文架构
```
上下文分配策略:
├── 基础信息 (30%) ── 角色设定、故事背景、大纲
├── 近期内容 (50%) ── 最近2-3章的完整文本  
└── 历史摘要 (20%) ── 早期章节的关键信息
```

#### 2. 智能Token优化
- **动态内容选择**: 根据当前写作需要选择最相关的历史内容
- **自动摘要压缩**: 将冗长章节压缩为关键信息点
- **Token预算管理**: 智能分配token使用，最大化有效信息密度

## 📦 快速开始

### 安装依赖

```bash
# 虚拟环境已创建（venv/）
# 依赖已安装（openai, python-dotenv）
```

### 配置API

1. 复制 `.env.example` 到 `.env`
2. 在 `.env` 中设置你的Grok API密钥：
```env
XAI_API_KEY=your_grok_api_key_here
XAI_BASE_URL=https://api.x.ai/v1
```

## 🚀 使用方法

### 🌐 Web界面（推荐）

```bash
# 启动Web服务器
python web_api.py

# 在浏览器中访问
http://localhost:5001
```

**Web界面功能**：
- ✅ 创建和管理项目
- ✅ 添加和编辑角色
- ✅ 查看角色经历
- ✅ 手动添加和编辑章节
- ✅ AI生成新章节
- ✅ 获取情节建议
- ✅ 实时统计数据可视化
- ✅ 美观的现代化界面
```

## 📄 许可证

MIT License
